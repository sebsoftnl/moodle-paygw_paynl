{"version":3,"sources":["../src/startpayment.js"],"names":["getSelectedPaymentMethod","el","document","querySelector","value","startPayment","selector","doCreateTransaction","e","preventDefault","invokeElement","currentTarget","Repository","createPayment","data","then","result","success","window","location","href","redirecturl","fail","Notification","exception","on"],"mappings":"8eAwBA,OACA,OACA,O,ylBAOA,QAASA,CAAAA,CAAT,EAAoC,CAChC,GAAIC,CAAAA,CAAE,CAAGC,QAAQ,CAACC,aAAT,CAAuB,gDAAvB,CAAT,CACA,GAAkB,WAAd,QAAOF,CAAAA,CAAP,EAAoC,IAAP,GAAAA,CAAjC,CAA8C,CAC1C,MAAOA,CAAAA,CAAE,CAACG,KACb,CACD,MAAO,KACV,CAQM,GAAMC,CAAAA,CAAY,CAAG,SAACC,CAAD,CAAc,CACtC,GAAMC,CAAAA,CAAmB,CAAG,SAASC,CAAT,CAAY,CACpCA,CAAC,CAACC,cAAF,GACA,GAAIC,CAAAA,CAAa,CAAG,cAAEF,CAAC,CAACG,aAAJ,CAApB,CACAC,CAAU,CAACC,aAAX,CACQH,CAAa,CAACI,IAAd,CAAmB,WAAnB,CADR,CAEQJ,CAAa,CAACI,IAAd,CAAmB,aAAnB,CAFR,CAGQJ,CAAa,CAACI,IAAd,CAAmB,QAAnB,CAHR,CAIQJ,CAAa,CAACI,IAAd,CAAmB,aAAnB,CAJR,CAKQd,CAAwB,EALhC,CAMQ,IANR,EAOEe,IAPF,CAOO,SAASC,CAAT,CAAiB,CACpB,GAAIA,CAAM,CAACC,OAAX,CAAoB,CAChBC,MAAM,CAACC,QAAP,CAAgBC,IAAhB,CAAuBJ,CAAM,CAACK,WACjC,CAGJ,CAbD,EAaGC,IAbH,CAaQC,UAAaC,SAbrB,CAcH,CAjBD,CAkBA,cAAElB,CAAF,EAAYmB,EAAZ,CAAe,OAAf,CAAwBlB,CAAxB,CACH,CApBM,C","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Payment implementation for paynl system.\n *\n * @package    paygw_paynl\n * @module     paygw_paynl/startpayment\n * @copyright  2021 Ing. R.J. van Dongen <rogier@sebsoft.nl>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport $ from 'jquery';\nimport * as Repository from 'paygw_paynl/repository';\nimport Notification from 'core/notification';\n\n/**\n * Detect selected payment method (if we have one).\n *\n * @returns {String|null}\n */\nfunction getSelectedPaymentMethod() {\n    let el = document.querySelector('input[name=\"method\"][type=\"radio\"]:checked');\n    if (typeof el !== 'undefined' && el !== null) {\n        return el.value;\n    }\n    return null;\n}\n\n/**\n * Create payment in the backend and redirect.\n *\n * @param {String} selector\n * @returns {void}\n */\nexport const startPayment = (selector) => {\n    const doCreateTransaction = function(e) {\n        e.preventDefault();\n        let invokeElement = $(e.currentTarget);\n        Repository.createPayment(\n                invokeElement.data('component'),\n                invokeElement.data('paymentarea'),\n                invokeElement.data('itemid'),\n                invokeElement.data('description'),\n                getSelectedPaymentMethod(),\n                null,\n        ).then(function(result) {\n            if (result.success) {\n                window.location.href = result.redirecturl;\n            } else {\n                // hmmmm.\n            }\n        }).fail(Notification.exception);\n    };\n    $(selector).on('click', doCreateTransaction);\n};\n"],"file":"startpayment.min.js"}